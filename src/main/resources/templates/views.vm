--
-- Copyright 2008 Glencoe Software, Inc. All rights reserved.
-- Use is subject to license terms supplied in LICENSE.txt
--

-- This file was generated by omero-model/src/main/resources/templates/views.vm
-- and can be used to overwrite the generated Map<Long, Long> tables
-- with functional views.

#foreach($type in $types)
#foreach($prop in $type.classProperties)
#if($prop.one2Many && $prop.isLink && !$type.global)
  DROP TABLE ${type.countName($prop)};

  CREATE OR REPLACE VIEW ${type.countName($prop)} (${type.shortname}_id, owner_id, count) AS select ${prop.inverse}, owner_id, count(*)
    FROM ${prop.actualTarget.tableName()} GROUP BY ${prop.inverse}, owner_id ORDER BY ${prop.inverse};

#end
#end
#end
